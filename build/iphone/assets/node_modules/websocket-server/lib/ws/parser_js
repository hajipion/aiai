function Parser(e){events.EventEmitter.call(this),this.version=e.toLowerCase()||"draft76",this.readable=!0,this.paused=!1,("draft76"==this.version||"draft75"==this.version)&&(this.frameData=[],this.frameStage="begin")}var sys=require("sys"),events=require("events");module.exports=Parser,sys.inherits(Parser,events.EventEmitter),Parser.prototype.write=function(e){for(var t,r=0,o=e.length;o>r;r++)0==this.order?this.order=true&e[r]?1:-1:-1==this.order?255===e[r]?(t=new Buffer(this.frameData),this.order=0,this.frameData=[],this.emit("data",t.toString("utf8",0,t.length))):this.frameData.push(e[r]):1==this.order&&(this.emit("error","High Order packet handling is not yet implemented."),this.order=0)},Parser.prototype.destroy=function(){delete this.order,delete this.frameData},exports.createParseStream=function(e){return new ParserStream(e)};var ParserStream=exports.ParseStream=function(e){events.EventEmitter.call(this),this.readable=!0,this.writable=!0,this.paused=!1,this.version=e.toLowerCase()||"draft76",this.bufferSize=40960,this.buffer=new Buffer(this.bufferSize),this.frameBuffer=[],this.parseState=""};sys.inherits(ParserStream,events.EventEmitter),ParserStream.prototype._read=function(){var e=this;if(e.readable&&!e.paused){var t=new events.EventEmitter;this.emit("message",t)}},ParserStream.prototype.pause=function(){this.paused=!0},ParserStream.prototype.resume=function(){this.paused=!1},ParserStream.prototype.destroy=function(){},ParserStream.prototype.write=function(){},ParserStream.prototype.flush=function(){},ParserStream.prototype.end=function(){};