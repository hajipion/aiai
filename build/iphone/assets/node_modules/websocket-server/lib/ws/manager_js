function Manager(e){if(events.EventEmitter.call(this),e.debug){var t=this;debug=function(e,r){r&&r.id?util.error("[31mManager: "+e+": <Connection "+r.id+"> "+"("+t._length+")[39m"):util.error("[31mManager: "+Array.prototype.join.call(arguments," ")+" ("+t._length+")[39m")}}this._head=null,this._tail=null,this._length=0,this._counter=0}var debug=function(){},util=require("../_util"),events=require("../_events");module.exports=Manager,util.inherits(Manager,events.EventEmitter),Object.defineProperty(Manager.prototype,"length",{get:function(){return this._length}}),Manager.prototype.createId=function(e){return process.pid+""+e+this._counter++},Manager.prototype.inspect=function(){return"<WS:Manager "+this._length+" (total: "+this._counter+")>"},Manager.prototype.attach=function(e){var t={id:e.id,_next:null,connection:e};0==this._length?(this._head=t,this._tail=t):(this._tail._next=t,this._tail=t),++this._length,this.emit("attach",e),debug("Attached",e)},Manager.prototype.detach=function(e){for(var t=current=this._head,r=e.id;null!==current;){if(current.id===r){t._next=current._next,current.id===this._head.id&&(this._head=current._next),current.id===this._tail.id&&(this._tail=t),this._length--,this.emit("detach",e),debug("Detached",e);break}t=current,current=current._next}null===current&&debug("Detach Failed",e),delete current,t},Manager.prototype.find=function(e,t,r){for(var o=this._head;null!==o;){if(o.id===e){t.call(r,o.connection);break}o=o._next}},Manager.prototype.forEach=function(e,t){for(var r=this._head;null!==r;)e.call(t,r.connection),r=r._next},Manager.prototype.map=function(e,t){for(var r=this._head,o=[],i=0;null!==r;)o.push(e.call(t,r.connection,i,this._head)),r=r._next,i++;return o},Manager.prototype.filter=function(e,t){for(var r=this._head,o=[],i=0;null!==r;)Boolean(e.call(t,r.connection,i,this._head))&&o.push(r.connection),r=r._next,i++;return o};