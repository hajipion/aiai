function BufferList(e){if(!(this instanceof BufferList))return new BufferList(e);EventEmitter.call(this);var t=this;e===void 0&&(e={}),t.encoding=e.encoding,t.construct=e.construct||Buffer;var o={next:null,buffer:null},i={next:null,buffer:null},r=0;t.__defineGetter__("length",function(){return r});var n=0;t.write=function(e){return o.buffer?(i.next={next:null,buffer:e},i=i.next):(o.buffer=e,i=o),r+=e.length,t.emit("write",e),!0},t.end=function(e){Buffer.isBuffer(e)&&t.write(e)},t.push=function(){var e=[].concat.apply([],arguments);return e.forEach(t.write),t},t.forEach=function(e){if(!o.buffer)return new t.construct(0);if(0>=o.buffer.length-n)return t;for(var i=o.buffer.slice(n),r={buffer:i,next:o.next};r&&r.buffer;){var s=e(r.buffer);if(s)break;r=r.next}return t},t.join=function(e,i){if(!o.buffer)return new t.construct(0);void 0==e&&(e=0),void 0==i&&(i=t.length);var r=new t.construct(i-e),n=0;return t.forEach(function(t){return n+t.length>e&&i>n&&t.copy(r,Math.max(0,n-e),Math.max(0,e-n),Math.min(t.length,i-n)),n+=t.length,n>i?!0:void 0}),r},t.joinInto=function(e,i,r,n){if(!o.buffer)return new t.construct(0);void 0==r&&(r=0),void 0==n&&(n=t.length);var s=e;if(n-r>s.length-i)throw Error("Insufficient space available in target Buffer.");var a=0;return t.forEach(function(e){return a+e.length>r&&n>a&&e.copy(s,Math.max(i,i+a-r),Math.max(0,r-a),Math.min(e.length,n-a)),a+=e.length,a>n?!0:void 0}),s},t.advance=function(e){for(n+=e,r-=e;o.buffer&&n>=o.buffer.length;)n-=o.buffer.length,o=o.next?o.next:{buffer:null,next:null};return t.emit("advance",e),t},t.take=function(e,o){if(void 0==e?e=t.length:"number"!=typeof e&&(o=e,e=t.length),o||(o=t.encoding),o){var i="";return t.forEach(function(t){return 0>=e?!0:(i+=t.toString(o,0,Math.min(e,t.length)),e-=t.length,void 0)}),i}return t.join(0,e)},t.toString=function(){return t.take("binary")}}var Buffer=require("buffer").Buffer,EventEmitter=require("events").EventEmitter;module.exports=BufferList,module.exports.BufferList=BufferList,require("util").inherits(BufferList,EventEmitter);