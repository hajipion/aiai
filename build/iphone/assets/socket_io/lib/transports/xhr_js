(function(e,t,o){function n(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function r(){}e.XHR=n,t.util.inherit(n,t.Transport),n.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},n.prototype.payload=function(e){for(var o=[],n=0,r=e.length;r>n;n++)o.push(t.parser.encodePacket(e[n]));this.send(t.parser.encodePayload(o))},n.prototype.send=function(e){return this.post(e),this},n.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=r,i.posting=!1,200==this.status?i.socket.setBuffer(!1):i.onClose())}function n(){this.onload=r,i.socket.setBuffer(!1)}var i=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),o.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=n:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},n.prototype.close=function(){return this.onClose(),this},n.prototype.request=function(e){var o=t.util.request(this.socket.isXDomain()),n=t.util.query(this.socket.options.query,"t="+ +new Date);if(o.open(e||"GET",this.prepareUrl()+n,!0),"POST"==e)try{o.setRequestHeader?o.setRequestHeader("Content-type","text/plain;charset=UTF-8"):o.contentType="text/plain"}catch(r){}return o},n.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},n.check=function(e,o){try{if(t.util.request(o))return!0}catch(n){}return!1},n.xdomainCheck=function(){return n.check(null,!0)}})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);