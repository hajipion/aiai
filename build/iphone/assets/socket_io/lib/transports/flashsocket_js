(function(e,t){function o(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=o,t.util.inherit(o,t.Transport.websocket),o.prototype.name="flashsocket",o.prototype.open=function(){var e=this,o=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,o)}),this},o.prototype.send=function(){var e=this,o=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,o)}),this},o.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},o.prototype.ready=function(e,n){function r(){var t=e.options,r=t["flash policy port"],s=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];o.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=s.join("/")),843!==r&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+r),WebSocket.__initialize(),o.loaded=!0),n.call(i)}var i=this;return document.body?r():(t.util.load(r),void 0)},o.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},o.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports);