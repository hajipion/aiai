function load(e,t){module={},$script("/test/"+e,function(){t(module.exports)})}function run(){function e(){$("body").append("<p>All suites completed</p>")}var t=Array.prototype.slice.call(arguments),n=0;t.length?(testsList=$('<ul class="test-list">'),$("body").append(testsList),suite(t[n],function o(){t[++n]?suite(t[n],o):e()})):e()}function keys(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function suite(e,t){var n={},o={};currentSuite=e;var r=$('<li class="loading">').append($('<span class="name">').append($("<a>").attr("href","/test/"+e).text(e))).appendTo(testsList);load(e,function(e){function i(){var e=!keys(o).length,i=Math.round((new Date-s)/1e3);r.removeClass("loading"),r.append('<span class="bullet">&bull;</span>'),e?r.append(" all passed"):(r.append(" failing test"),r.addClass("test-failure")),r.append($('<div class="details">').html("Passed: "+keys(n).length+" &mdash; Failed: <em>"+keys(o).length+"</em> &mdash; Elapsed: <em>"+i+"</em> seconds &mdash; ").append($("<a>Show details</a>").attr("href","#").click(function(){return r.toggleClass("cases"),$(this).text(r.hasClass("cases")?"Hide details":"Show details"),!1})));for(var c=$('<ul class="cases">').appendTo(r),u=0,l=a.length;l>u;u++){var p=$("<li>").text(a[u]).addClass(o[a[u]]?"failed":"").appendTo(c);o[a[u]]&&(window.console&&console.log&&console.log(o[a[u]]),p.append($('<span class="error">').text(o[a[u]]+"")))}t({status:e,passed:n,failed:o})}if(e){var s=new Date,a=keys(e),c=0;if(!a.length)return i();currentCase=a[c],test(e[a[c]],function u(t){t?o[a[c]]=t:n[a[c]]=!0,a[++c]?(currentCase=a[c],test(e[a[c]],u)):i()})}})}function test(e,t){function n(e){n.run||(o&&clearTimeout(o),n.run=!0,window.onerror=null,t(e))}var o;window.onerror=function(e){n(e)};try{if(e.length>0){var o=setTimeout(function(){n(Error("Timeout"))},2e3);e(n)}else e(),n()}catch(r){n(r)}}function create(e){if(!testsPorts[currentSuite])throw Error('No socket server defined for suite "'+currentSuite+'"');if(!testsPorts[currentSuite][currentCase])throw Error('No socket server defined for suite "'+currentSuite+'" and case "'+currentCase+'"');return io.connect(uri()+(e||""))}function uri(){return document.location.protocol+"//"+document.location.hostname+":"+testsPorts[currentSuite][currentCase]}var currentSuite,currentCase,testsList;