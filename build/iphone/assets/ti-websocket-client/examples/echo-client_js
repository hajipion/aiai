var WebSocket=require("ti-websocket-client").WebSocket,win=Ti.UI.createWindow({title:"WebSocket",backgroundColor:"#fff"}),textarea=Ti.UI.createTextArea({backgroundColor:"#eee",value:"",editable:!1,top:70,left:0,right:0,bottom:0});win.add(textarea);var connectBtn=Ti.UI.createButton({title:"Connect",font:{fontSize:16,fontFamily:"Helvetica Neue"},textAlign:"center",width:100,height:20,top:5,left:5});win.add(connectBtn);var ws;connectBtn.addEventListener("click",function(){ws=new WebSocket("ws://localhost:3000/"),ws.onopen=function(){Ti.API.info("message Connected"),log("Connected")},ws.onclose=function(){log("Disconnected")},ws.onmessage=function(e){log("> "+e.data)},ws.onerror=function(e){log("Error: "+(e?JSON.stringify(e):"A unknown error occurred"))},log("Connecting...")});var closeBtn=Ti.UI.createButton({title:"Close",font:{fontSize:16,fontFamily:"Helvetica Neue"},textAlign:"center",width:100,height:20,top:5,right:5});win.add(closeBtn),closeBtn.addEventListener("click",function(){ws.close()});var log=function(e){textarea.value+=e+"\n"},messageField=Ti.UI.createTextField({borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,width:230,height:30,top:35,left:5});win.add(messageField);var sendBtn=Ti.UI.createButton({title:"Send",font:{fontSize:16,fontFamily:"Helvetica Neue"},textAlign:"center",width:70,height:30,top:35,right:5});win.add(sendBtn),sendBtn.addEventListener("click",function(){var e=messageField.value;log("< "+e),ws.send(e),messageField.value="",messageField.blur()}),win.open();