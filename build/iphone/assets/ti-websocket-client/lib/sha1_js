var SHA1=function(){function e(e){e&=4294967295,0>e&&(e+=4294967296);var t=Number(e).toString(16);return 8>t.length&&(t="00000000".substr(0,8-t.length)+t),t}function t(e){var t=e+1+64;return 512*Math.ceil(t/512)/32}function n(e){var n,o=e.length,r=t(8*o),i=Array(r);for(n=0,j=0;o>n;)i[j++]=(255&e.charCodeAt(n++))<<24|(255&e.charCodeAt(n++))<<16|(255&e.charCodeAt(n++))<<8|255&e.charCodeAt(n++);for(;r>j;)i[j++]=0;return i}function o(e,t,n){if(n>4294967295){var o=4294967295&n;0>o&&(o+=4294967296),e[t-1]=o,e[t-2]=(n-o)/4294967296}else e[t-1]=n,e[t-2]=0;return e}function r(e,n){var r=Math.floor(n/32);return e[r]|=1<<32*(r+1)-n-1,o(e,t(n),n),e}function i(e){for(var t=0,n=0,o=[1732584193,4023233417,2562383102,271733878,3285377520];e.length>t;){var r=Array(80);for(n=0;16>n;n++)r[n]=e[t++];for(n=16;80>n;n++){var i=r[n-3]^r[n-8]^r[n-14]^r[n-16];r[n]=i<<1|i>>>31}var s=o[0],a=o[1],c=o[2],u=o[3],l=o[4];for(n=0;80>n;n++){var p=(s<<5|s>>>27)+l+r[n];n>=0&&19>=n?p+=(a&c|~a&u)+1518500249:n>=20&&39>=n?p+=(a^c^u)+1859775393:n>=40&&59>=n?p+=(a&c|a&u|c&u)+2400959708:n>=60&&79>=n&&(p+=(a^c^u)+3395469782),l=u,u=c,c=a<<30|a>>>2,a=s,s=p}o[0]=4294967295&o[0]+s,o[1]=4294967295&o[1]+a,o[2]=4294967295&o[2]+c,o[3]=4294967295&o[3]+u,o[4]=4294967295&o[4]+l,0>o[0]&&(o[0]+=4294967296),0>o[1]&&(o[1]+=4294967296),0>o[2]&&(o[2]+=4294967296),0>o[3]&&(o[3]+=4294967296),0>o[4]&&(o[4]+=4294967296)}return o}var s;s={enabled:!0,equals:function(e,t){var n;if(e instanceof Array&&t instanceof Array){if(e.length!==t.length)return!1;for(n=0;e.length>n;n++)if(!s.equals(e[n],t[n]))return!1;return!0}if(null!==e&&null!==t&&"object"==typeof e&&"object"==typeof t){for(n in e)if(e.hasOwnProperty(n)&&!s.equals(e[n],t[n]))return!1;return!0}return e===t},should:function(e,t){if(s.currentIndicator++,!e){var n=["[Spec failed",s.currentTitle?" ("+s.currentTitle+")] ":"] ",t||s.currentMessage+" "+s.currentIndicator||""].join("");throw alert(n),n}return!!e},describe:function(e,t){s.currentTitle=e;var n;for(n in t)t.hasOwnProperty(n)&&(s.currentMessage=n,s.currentIndicator=0,t[n](),s.currentIndicator=null);s.currentMessage=s.currentTitle=null},Version:"0.1"},s.should.equal=function(e,t,n){return s.should(s.equals(e,t),n)},s.should.not=function(e,t){return s.should(!e,t)},s.should.not.equal=function(e,t,n){return s.should(!s.equals(e,t),n)},s.enabled||(s.describe=function(){}),s.describe("Spec object",{should:function(){s.should(!0),s.should(1)},"should.not":function(){s.should.not(!1),s.should.not(0)},"should.equal":function(){s.should.equal(null,null),s.should.equal("",""),s.should.equal(12345,12345),s.should.equal([0,1,2],[0,1,2]),s.should.equal([0,1,[0,1,2]],[0,1,[0,1,2]]),s.should.equal({},{}),s.should.equal({x:1},{x:1}),s.should.equal({x:[1]},{x:[1]})},"should.not.equal":function(){s.should.not.equal([1,2,3],[1,2,3,4]),s.should.not.equal({x:1},[1,2,3,4])}}),s.describe("sha1",{strfhex32:function(){s.should.equal(e(0),"00000000"),s.should.equal(e(291),"00000123"),s.should.equal(e(4294967295),"ffffffff")}}),s.describe("sha1",{padding_size:function(){s.should.equal(t(0),16),s.should.equal(t(1),16),s.should.equal(t(447),16),s.should.equal(t(448),32)}}),s.describe("sha1",{word_array:function(){s.should.equal(n(""),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s.should.equal(n("1234")[0],825373492)}}),s.describe("sha1",{write_nbits:function(){s.should.equal(o([0,0],2,1),[0,1]),s.should.equal(o([0,0],2,4294967295),[0,4294967295]),s.should.equal(o([0,0],2,4294967296),[1,0]),s.should.equal(o([0,0],2,8589934591),[1,4294967295]),s.should.equal(o([0,0],2,1249835483136),[291,0]),s.should.equal(o([0,0],2,1252717883154),[291,2882400018])}});var a=function(e){this.message=e};return _base64_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a.prototype={digest:function(){var e=8*this.message.length,t=r(n(this.message),e);return i(t)},base64digest:function(){for(var e,t,n,o,r,i,s,a=this.hexdigest(),c="",u=0;a.length>u;)e=parseInt(a.substring(u,u+2),16),t=parseInt(a.substring(u+2,u+4),16),n=parseInt(a.substring(u+4,u+6),16),o=e>>2,r=(3&e)<<4|t>>4,i=(15&t)<<2|n>>6,s=63&n,isNaN(t)?i=s=64:isNaN(n)&&(s=64),c=c+_base64_keyStr.charAt(o)+_base64_keyStr.charAt(r)+_base64_keyStr.charAt(i)+_base64_keyStr.charAt(s),u+=6;return c},hexdigest:function(){var t,n=this.digest();for(t=0;n.length>t;t++)n[t]=e(n[t]);return n.join("")}},s.describe("sha1",{"SHA1#hexdigest":function(){s.should.equal(new a("").hexdigest(),"da39a3ee5e6b4b0d3255bfef95601890afd80709"),s.should.equal(new a("1").hexdigest(),"356a192b7913b04c54574d18c28d46e6395428ab"),s.should.equal(new a("Hello.").hexdigest(),"9b56d519ccd9e1e5b2a725e186184cdc68de0731"),s.should.equal(new a("9b56d519ccd9e1e5b2a725e186184cdc68de0731").hexdigest(),"f042dc98a62cbad68dbe21f11bbc1e9d416d2bf6"),s.should.equal(new a("MD5abZRVSXZVRcasdfasdddddddddddddddds+BNRJFSLKJFN+SEONBBJFJXLKCJFSE)RUNVXDLILKVJRN)#NVFJ)WVFWRW#)NVS$Q=$dddddddddddddWV;no9wurJFSE)RUNVXDLILKVJRN)#NVFJ)WVFWRW#)NVS$Q=$dddddddddddddWV;no9wurJFSE)RUNVXDLILKVJRN)#NVFJ)WVFWRW#)NVS$Q=$dddddddddddddWV;no9wurJFSE)RUNVXDLILKVJRN)#NVFJ)WVFWRW#)NVS$Q=$dddddddddddddWV;no9wuraddddddasdfasdfd").hexdigest(),"662dbf4ebc9cdb4224766e87634e5ba9e6de672b")}}),a}();exports.SHA1=SHA1;